<template>
    <div class="top-bar2">
        <div class="container-md container-fluid">
            <div class="row">
                <div class="col-lg-12 d-flex align-items-center justify-content-between gap-3">
                    <div class="top-bar-left">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
                            <g clip-path="url(#clip0_1038_9)">
                              <path d="M12.6448 9.91122C12.3172 9.57015 11.9221 9.3878 11.5034 9.3878C11.088 9.3878 10.6895 9.56678 10.3485 9.90784L9.28136 10.9716C9.19356 10.9243 9.10576 10.8804 9.02133 10.8365C8.89977 10.7757 8.78495 10.7183 8.68702 10.6575C7.68746 10.0227 6.77907 9.19532 5.90782 8.12484C5.48571 7.59128 5.20205 7.14215 4.99606 6.68627C5.27296 6.433 5.52961 6.1696 5.7795 5.91634C5.87406 5.82178 5.96861 5.72385 6.06316 5.6293C6.77231 4.92015 6.77231 4.00163 6.06316 3.29248L5.14127 2.37058C5.03658 2.2659 4.92852 2.15783 4.82721 2.04977C4.6246 1.84041 4.41185 1.62428 4.19235 1.42167C3.86479 1.09748 3.47307 0.925262 3.06109 0.925262C2.64911 0.925262 2.25063 1.09748 1.91294 1.42167C1.90956 1.42505 1.90956 1.42505 1.90619 1.42842L0.758037 2.5867C0.325793 3.01895 0.0792786 3.54575 0.025248 4.15697C-0.0557978 5.14302 0.234616 6.06154 0.457492 6.66263C1.00455 8.13834 1.82176 9.50599 3.04083 10.9716C4.51991 12.7377 6.29955 14.1324 8.33245 15.115C9.10913 15.4831 10.1458 15.9187 11.3041 15.993C11.375 15.9964 11.4493 15.9998 11.5169 15.9998C12.2969 15.9998 12.9521 15.7195 13.4653 15.1623C13.4687 15.1556 13.4755 15.1522 13.4789 15.1454C13.6545 14.9327 13.8571 14.7402 14.0698 14.5342C14.215 14.3958 14.3636 14.2506 14.5088 14.0986C14.8431 13.7508 15.0187 13.3455 15.0187 12.9302C15.0187 12.5114 14.8397 12.1096 14.4987 11.7719L12.6448 9.91122ZM13.8537 13.4671C13.8503 13.4671 13.8503 13.4705 13.8537 13.4671C13.722 13.6089 13.5869 13.7373 13.4417 13.8791C13.2222 14.0885 12.9993 14.308 12.79 14.5545C12.4489 14.9192 12.047 15.0914 11.5202 15.0914C11.4696 15.0914 11.4156 15.0914 11.3649 15.088C10.362 15.0239 9.42994 14.6321 8.73092 14.2978C6.81959 13.3726 5.14127 12.0589 3.7466 10.3941C2.59508 9.00621 1.82514 7.72298 1.31523 6.3452C1.00117 5.50435 0.88636 4.84923 0.937014 4.23126C0.970783 3.83616 1.12274 3.5086 1.40303 3.22832L2.55455 2.07679C2.72002 1.92145 2.89562 1.83703 3.06784 1.83703C3.28059 1.83703 3.45281 1.96535 3.56087 2.07341C3.56425 2.07679 3.56763 2.08017 3.571 2.08354C3.77699 2.27603 3.97286 2.47526 4.17885 2.68801C4.28353 2.79607 4.39159 2.90413 4.49965 3.01557L5.42155 3.93747C5.7795 4.29542 5.7795 4.62636 5.42155 4.98431C5.32362 5.08224 5.22906 5.18017 5.13113 5.27472C4.84747 5.56514 4.57732 5.83529 4.28353 6.09869C4.27678 6.10544 4.27002 6.10882 4.26665 6.11557C3.97623 6.40599 4.03026 6.68965 4.09105 6.88213C4.09442 6.89226 4.0978 6.90239 4.10118 6.91252C4.34094 7.49335 4.67863 8.04041 5.19192 8.69216L5.1953 8.69553C6.12732 9.84368 7.11 10.7386 8.19399 11.4241C8.33245 11.5119 8.47427 11.5828 8.60935 11.6503C8.73092 11.7111 8.84573 11.7685 8.94367 11.8293C8.95717 11.8361 8.97068 11.8462 8.98419 11.8529C9.099 11.9104 9.20706 11.9374 9.3185 11.9374C9.59879 11.9374 9.77439 11.7618 9.83179 11.7044L10.9867 10.5495C11.1015 10.4346 11.2839 10.2962 11.4966 10.2962C11.706 10.2962 11.8782 10.4279 11.9829 10.5427C11.9863 10.5461 11.9863 10.5461 11.9896 10.5495L13.8503 12.4101C14.1981 12.7546 14.1981 13.1092 13.8537 13.4671Z"/>
                              <path d="M8.64606 3.80613C9.53081 3.95471 10.3345 4.37345 10.9761 5.01506C11.6177 5.65667 12.0331 6.46038 12.1851 7.34513C12.2222 7.568 12.4147 7.72334 12.6342 7.72334C12.6612 7.72334 12.6848 7.71996 12.7119 7.71659C12.9617 7.67606 13.1272 7.43968 13.0867 7.18979C12.9043 6.11931 12.3978 5.14338 11.6245 4.37007C10.8512 3.59676 9.87526 3.09022 8.80478 2.90787C8.55489 2.86734 8.32188 3.03281 8.27798 3.27933C8.23408 3.52584 8.39617 3.7656 8.64606 3.80613Z"/>
                              <path d="M15.9811 7.05794C15.6806 5.29519 14.8499 3.69116 13.5734 2.41469C12.2969 1.13821 10.6929 0.307495 8.93016 0.00695018C8.68364 -0.0369496 8.45063 0.131896 8.40673 0.37841C8.36621 0.628301 8.53168 0.861308 8.78157 0.905208C10.3552 1.17198 11.7904 1.91828 12.9318 3.0563C14.0732 4.19769 14.8161 5.63288 15.0829 7.20652C15.12 7.4294 15.3125 7.58473 15.532 7.58473C15.559 7.58473 15.5827 7.58136 15.6097 7.57798C15.8562 7.54083 16.025 7.30445 15.9811 7.05794Z"/>
                            </g>
                        </svg>
                        <a href="tel:+961 76 836 886">+961 76 836 886</a>
                    </div>
                    <p>Enjoy Free shipping for orders over $30! <a href="shop-list.html">Shop Now</a></p>
                    <div class="social-area">
                        <ul>
                            <li>
                                <a href="https://www.facebook.com/">
                                    <i class="fab fa-facebook-f"></i>
                                </a>
                            </li>
                     
                            <li>
                                <a href="https://www.whatsapp.com/">
                                    <i class="fab fa-whatsapp"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://www.instagram.com/">
                                    <i class="fab fa-instagram"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Start home2 header section -->
    <header class="header-area style-2">
        <div class="container-md position-relative  d-flex flex-nowrap align-items-center justify-content-between">
            <div class="header-logo d-lg-none d-flex">
                <Link href="/"><img alt="image" class=" w-[150px] p-2" src="assets/img/nanologo.png" ></Link>
            </div>
            <div class="company-logo d-lg-flex d-none">
                    <Link href="/"><img src="assets/img/nanologo.png" alt="" class="w-[150px] p-2"></Link>
            </div>
            <div class="main-menu">
                <div class="mobile-logo-area d-lg-none d-flex justify-content-between align-items-center">
                    <div class="mobile-logo-wrap">
                          <Link href="/"><img alt="image" src="assets/img/nanologo.png" class="w-[150px] p-2"></Link>
                    </div>
                </div>
                <ul class="menu-list">
                    <li class="">
                        <Link href="/" class="drop-down" @click="closeMenu">Home</Link>
                    </li>      
                                    <li class="menu-item">
                      <Link href="/about" @click="closeMenu">About</Link>
               </li>   
                  <li class="menu-item">
                      <Link href="/products" @click="closeMenu">Our Products</Link>
               </li>        
                <li class="menu-item">
                      <Link href="/contact" @click="closeMenu">Contact</Link>
               </li>        
                </ul>
                <div class="d-lg-none d-block">
                    <form class="mobile-menu-form">
                        <div class="hotline pt-40">
                            <div class="hotline-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                                    <path d="M14.2333 11.1504C13.8642 10.7667 13.4191 10.5615 12.9473 10.5615C12.4794 10.5615 12.0304 10.7629 11.6462 11.1466L10.4439 12.3433C10.345 12.2901 10.2461 12.2407 10.151 12.1913C10.014 12.1229 9.88467 12.0583 9.77433 11.9899C8.64819 11.2757 7.62476 10.345 6.64319 9.14067C6.16762 8.54043 5.84804 8.03516 5.61596 7.52229C5.92793 7.23736 6.21708 6.94104 6.49861 6.65611C6.60514 6.54974 6.71167 6.43957 6.8182 6.33319C7.61715 5.5354 7.61715 4.50207 6.8182 3.70427L5.77955 2.66714C5.66161 2.54937 5.53987 2.4278 5.42573 2.30623C5.19746 2.07069 4.95777 1.82755 4.71047 1.59961C4.34143 1.2349 3.9001 1.04115 3.43595 1.04115C2.97179 1.04115 2.52286 1.2349 2.1424 1.59961L2.13479 1.60721L0.841243 2.91027C0.35426 3.39655 0.076528 3.9892 0.0156552 4.67682C-0.0756541 5.78614 0.251537 6.81947 0.502638 7.4957C1.11898 9.15587 2.03968 10.6945 3.41312 12.3433C5.07952 14.3301 7.08452 15.8991 9.37486 17.0047C10.2499 17.4187 11.4179 17.9088 12.7229 17.9924C12.8028 17.9962 12.8865 18 12.9626 18C13.8414 18 14.5795 17.6847 15.1578 17.0578C15.1616 17.0502 15.1692 17.0464 15.173 17.0388C15.3708 16.7995 15.5991 16.583 15.8388 16.3512C16.0024 16.1955 16.1698 16.0321 16.3334 15.8611C16.71 15.4698 16.9079 15.014 16.9079 14.5467C16.9079 14.0756 16.7062 13.6235 16.322 13.2436L14.2333 11.1504ZM15.5953 15.1507C15.5915 15.1545 15.5915 15.1507 15.5953 15.1507C15.4469 15.3103 15.2947 15.4547 15.1311 15.6142C14.8838 15.8498 14.6327 16.0967 14.3969 16.374C14.0126 16.7843 13.5599 16.9781 12.9664 16.9781C12.9093 16.9781 12.8484 16.9781 12.7913 16.9743C11.6614 16.9021 10.6113 16.4614 9.82379 16.0853C7.67042 15.0444 5.77955 13.5665 4.20827 11.6936C2.91092 10.1322 2.04348 8.68859 1.46899 7.13859C1.11517 6.19263 0.985816 5.45562 1.04288 4.7604C1.08093 4.31591 1.25214 3.94741 1.56791 3.63209L2.86527 2.33662C3.05169 2.16187 3.24953 2.06689 3.44356 2.06689C3.68324 2.06689 3.87728 2.21125 3.99902 2.33282L4.01044 2.34422C4.24251 2.56076 4.46318 2.78491 4.69526 3.02424C4.8132 3.14581 4.93494 3.26738 5.05669 3.39275L6.09533 4.42988C6.49861 4.83258 6.49861 5.20488 6.09533 5.60758C5.985 5.71775 5.87847 5.82792 5.76814 5.9343C5.44856 6.26101 5.14419 6.56494 4.8132 6.86126C4.80559 6.86886 4.79798 6.87266 4.79417 6.88025C4.46698 7.20697 4.52786 7.52609 4.59634 7.74263L4.60775 7.77682C4.87787 8.43026 5.25833 9.0457 5.83662 9.77891L5.84043 9.78271C6.89048 11.0744 7.99761 12.0811 9.21887 12.8523C9.37486 12.9511 9.53465 13.0309 9.68683 13.1069C9.82379 13.1752 9.95315 13.2398 10.0635 13.3082C10.0787 13.3158 10.0939 13.3272 10.1091 13.3348C10.2385 13.3994 10.3602 13.4298 10.4858 13.4298C10.8016 13.4298 10.9994 13.2322 11.0641 13.1676L12.3652 11.8684C12.4946 11.7392 12.7 11.5834 12.9397 11.5834C13.1756 11.5834 13.3696 11.7316 13.4876 11.8608L13.4952 11.8684L15.5915 13.9616C15.9834 14.3491 15.9834 14.748 15.5953 15.1507ZM9.72868 4.28172C10.7255 4.44888 11.631 4.91996 12.3538 5.64177C13.0767 6.36359 13.5446 7.26775 13.7159 8.2631C13.7577 8.51383 13.9746 8.68859 14.2219 8.68859C14.2523 8.68859 14.2789 8.68479 14.3094 8.68099C14.5909 8.6354 14.7773 8.36947 14.7317 8.08834C14.5262 6.88405 13.9555 5.78614 13.0843 4.91616C12.2131 4.04618 11.1135 3.47633 9.90749 3.27118C9.62596 3.22559 9.36344 3.41175 9.31398 3.68907C9.26452 3.9664 9.44714 4.23613 9.72868 4.28172ZM17.9922 7.94018C17.6536 5.95709 16.7176 4.15255 15.2795 2.71652C13.8414 1.28049 12.0342 0.345932 10.0483 0.00781895C9.77053 -0.0415684 9.50802 0.148383 9.45856 0.425712C9.4129 0.70684 9.59932 0.968972 9.88086 1.01836C11.6538 1.31848 13.2707 2.15807 14.5567 3.43834C15.8426 4.72241 16.6796 6.33699 16.9802 8.10734C17.022 8.35808 17.2389 8.53283 17.4862 8.53283C17.5166 8.53283 17.5432 8.52903 17.5737 8.52523C17.8514 8.48344 18.0416 8.21751 17.9922 7.94018Z"></path>
                                </svg>
                            </div>
                            <div class="hotline-info">
                                <span>Call Us Now</span>
                                <h6><a href="tel:+961 76 836 886">+961 76 836 886</a></h6>
                            </div>
                        </div>
                        <div class="email pt-4 d-flex align-items-center">
                            <div class="email-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20">
                                    <path d="M19.9018 8.6153C19.5412 5.99522 18.1517 3.62536 16.0393 2.02707C13.9268 0.428777 11.2643 -0.267025 8.63745 0.0927308C6.01063 0.452486 3.63468 1.83833 2.03228 3.94539C0.42988 6.05245 -0.267711 8.70813 0.0929693 11.3282C0.388972 13.4966 1.38745 15.509 2.9363 17.0589C4.48516 18.6088 6.49948 19.6113 8.67243 19.9136C9.11786 19.9713 9.56656 20.0002 10.0157 20C11.8278 20.0033 13.606 19.5101 15.1563 18.5744C15.2358 18.5318 15.3058 18.4735 15.362 18.4031C15.4182 18.3326 15.4595 18.2516 15.4833 18.1648C15.5072 18.078 15.5131 17.9872 15.5007 17.8981C15.4884 17.8089 15.458 17.7232 15.4114 17.6461C15.3648 17.569 15.303 17.5021 15.2298 17.4496C15.1565 17.397 15.0733 17.3599 14.9853 17.3403C14.8972 17.3208 14.806 17.3193 14.7173 17.336C14.6287 17.3527 14.5443 17.3871 14.4694 17.4373C12.7129 18.4904 10.6392 18.8886 8.61629 18.5613C6.59339 18.2339 4.75224 17.2022 3.4197 15.6492C2.08717 14.0962 1.34948 12.1225 1.3376 10.0784C1.32573 8.03438 2.04043 6.05225 3.35483 4.48397C4.66923 2.91568 6.49828 1.86271 8.51723 1.512C10.5362 1.16129 12.6144 1.53554 14.383 2.56829C16.1515 3.60104 17.4959 5.22548 18.1776 7.1532C18.8592 9.08092 18.8338 11.1872 18.1061 13.0981C17.9873 13.4102 17.7626 13.6709 17.4711 13.8349C17.1795 13.999 16.8396 14.056 16.5104 13.996C16.1811 13.9361 15.8833 13.763 15.6687 13.5068C15.454 13.2506 15.3362 12.9275 15.3356 12.5936V5.37867C15.3356 5.2024 15.2654 5.03336 15.1404 4.90872C15.0155 4.78408 14.846 4.71406 14.6693 4.71406C14.4925 4.71406 14.3231 4.78408 14.1981 4.90872C14.0731 5.03336 14.0029 5.2024 14.0029 5.37867V6.52578C13.2819 5.70734 12.3261 5.12961 11.265 4.8708C10.204 4.61198 9.08877 4.68456 8.0704 5.07873C7.05203 5.47289 6.17966 6.16961 5.57134 7.07458C4.96303 7.97954 4.64814 9.04908 4.66929 10.1384C4.69045 11.2278 5.04663 12.2843 5.68962 13.1651C6.33262 14.0459 7.23139 14.7084 8.2643 15.0629C9.2972 15.4175 10.4144 15.4469 11.4646 15.1473C12.5149 14.8477 13.4475 14.2335 14.1362 13.3878C14.3015 13.9385 14.6358 14.4237 15.092 14.775C15.5482 15.1263 16.1033 15.326 16.6793 15.3461C17.2553 15.3662 17.8231 15.2057 18.3028 14.887C18.7825 14.5684 19.15 14.1078 19.3535 13.5699C19.9483 11.99 20.1368 10.2866 19.9018 8.6153ZM10.0051 14.0185C9.21436 14.0185 8.4414 13.7847 7.78396 13.3465C7.12651 12.9083 6.61409 12.2856 6.3115 11.5569C6.00891 10.8283 5.92974 10.0265 6.08399 9.25296C6.23825 8.47943 6.61902 7.7689 7.17813 7.21122C7.73724 6.65354 8.4496 6.27376 9.22511 6.1199C10.0006 5.96603 10.8045 6.045 11.535 6.34681C12.2655 6.64863 12.8899 7.15973 13.3292 7.8155C13.7685 8.47126 14.0029 9.24223 14.0029 10.0309C14.0019 11.0882 13.5803 12.1018 12.8308 12.8494C12.0813 13.597 11.065 14.0175 10.0051 14.0185Z"></path>
                                </svg>
                            </div>
                            <div class="email-info">
                                <span>Email Now</span>
                                <h6><a href="/cdn-cgi/l/email-protection#b6d3ced7dbc6dad3f6d1dbd7dfda98d5d9db"><span class="__cf_email__" data-cfemail="f7928f969a879b92b7909a969e9bd994989a">[email&#160;protected]</span></a></h6>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="nav-right position-inherit d-flex jsutify-content-end align-items-center">
   
                <div class="dropdown">
                    <button type="button" class="modal-btn header-cart-btn">
                        <Link href="/cart">
                        <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M14.0139 18H3.98532C1.86389 18 0.128174 16.2643 0.128174 14.1429V14.0143L0.513888 3.72857C0.578174 1.60714 2.31389 0 4.37103 0H13.6282C15.6853 0 17.421 1.60714 17.4853 3.72857L17.871 14.0143C17.9353 15.0429 17.5496 16.0071 16.8425 16.7786C16.1353 17.55 15.171 18 14.1425 18H14.0139ZM4.37103 1.28571C2.95675 1.28571 1.86389 2.37857 1.7996 3.72857L1.41389 14.1429C1.41389 15.5571 2.57103 16.7143 3.98532 16.7143H14.1425C14.8496 16.7143 15.4925 16.3929 15.9425 15.8786C16.3925 15.3643 16.6496 14.7214 16.6496 14.0143L16.2639 3.72857C16.1996 2.31429 15.1067 1.28571 13.6925 1.28571H4.37103Z" />
                            <path
                                d="M8.99951 7.71427C6.49237 7.71427 4.49951 5.72141 4.49951 3.21427C4.49951 2.82855 4.75665 2.57141 5.14237 2.57141C5.52808 2.57141 5.78523 2.82855 5.78523 3.21427C5.78523 5.01427 7.19951 6.42855 8.99951 6.42855C10.7995 6.42855 12.2138 5.01427 12.2138 3.21427C12.2138 2.82855 12.4709 2.57141 12.8567 2.57141C13.2424 2.57141 13.4995 2.82855 13.4995 3.21427C13.4995 5.72141 11.5067 7.71427 8.99951 7.71427Z" />
                        </svg>
                    <span class="cart-count-badge">{{ cart.itemCount }}</span>
                    </Link>
                    </button>
             
                </div>
                <div class="save-btn">
                    <Link href="/wishlist">
                        <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_68_10)">
                                <path
                                    d="M16.528 2.20922C16.0674 1.71414 15.5099 1.31909 14.8902 1.04862C14.2704 0.778143 13.6017 0.638026 12.9255 0.636976C12.2487 0.637756 11.5794 0.777669 10.959 1.04803C10.3386 1.31839 9.78042 1.71341 9.31911 2.20857L9.00132 2.54439L8.68352 2.20857C6.83326 0.217182 3.71893 0.102819 1.72758 1.95309C1.63932 2.0351 1.5541 2.12032 1.47209 2.20857C-0.490696 4.32568 -0.490696 7.59756 1.47209 9.71466L8.5343 17.1622C8.77862 17.4201 9.18579 17.4312 9.44373 17.1869C9.45217 17.1789 9.46039 17.1707 9.46838 17.1622L16.528 9.71466C18.4907 7.59779 18.4907 4.32609 16.528 2.20922ZM15.5971 8.82882H15.5965L9.00132 15.7849L2.40553 8.82882C0.90608 7.21116 0.90608 4.71143 2.40553 3.09377C3.76722 1.61792 6.06755 1.52538 7.5434 2.88706C7.61505 2.95317 7.68401 3.02213 7.75012 3.09377L8.5343 3.92107C8.79272 4.17784 9.20995 4.17784 9.46838 3.92107L10.2526 3.09441C11.6142 1.61856 13.9146 1.52602 15.3904 2.8877C15.4621 2.95381 15.531 3.02277 15.5971 3.09441C17.1096 4.71464 17.1207 7.21893 15.5971 8.82882Z" />
                            </g>
                        </svg>
                             <span v-if="wishlist.items.length > 0" class="wishlist-count-badge">
            {{ wishlist.items.length }}
        </span>
                    </Link>
                </div>
             <div class="user-login">
                    <div v-if="$page.props.auth.user" class="relative">
                        <!-- User dropdown trigger -->
                        <button @click="toggleUserMenu" class="flex items-center gap-1">
                            <p class="text-sm">{{ $page.props.auth.user.name }}</p>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                        </button>
                        
                        <!-- Dropdown menu -->
                        <div v-show="userMenuOpen" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50">
                            <!-- Show Dashboard link only for admin (role = 1) -->
                            <Link v-if="$page.props.auth.user.role === 1" 
                                  href="/admin/dashboard" 
                                  class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                Dashboard
                            </Link>
                                     <Link v-if="$page.props.auth.user.role === 0" 
                                  href="/user/dashboard" 
                                  class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                Dashboard
                            </Link>
                            
          <button @click="handleLogout" 
            class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
        Logout
    </button>
                        </div>
                    </div>
                         <div v-else>
                        <Link href="/login" class="text-xs">Login</Link> | 
                        <Link href="/register" class="text-xs">Register</Link>
                    </div>
                    </div>
                <div class="sidebar-button mobile-menu-btn "  @click="sidebarToggle" :class="{ 'active': sidebarOpen }">
                    <span></span>
                </div>
            </div>
        </div>
    </header>
</template>

<script setup>
import { Link, router } from '@inertiajs/vue3'
import { ref, onMounted, onBeforeUnmount, watch } from 'vue'
import { useCartStore } from '@/stores/cart';
import { useWishlistStore } from '@/stores/wishlist';

const userMenuOpen = ref(false);
const cart = useCartStore();
const wishlist = useWishlistStore();


// Watch for changes in the cart store
watch(() => cart.items, () => {
    // This will automatically update through the itemCount computed property
}, { deep: true });

const handleLogout = async () => {
    try {
        // Clear client-side stores first
        await cart.fetchCartCount();
        wishlist.items = []; // Directly clear wishlist
        
        // Then perform logout
        await router.post(route('logout'));
        
        // Optional: Force reload to ensure complete state reset
        window.location.reload();
    } catch (error) {
        console.error('Logout error:', error);
        // Fallback: Still try to clear local state
        cart.items = [];
        cart.count = 0;
        wishlist.items = [];
    }
};
onMounted(() => {
    cart.fetchCartItems();
        cart.initialize();
            wishlist.fetchWishlist();

});
// State for sidebar/drawer
const sidebarOpen = ref(false)
const drawerOpen = ref(false)

// Toggle functions
const toggleDrawer = () => {
  drawerOpen.value = !drawerOpen.value
}

const sidebarToggle = () => {
  sidebarOpen.value = !sidebarOpen.value
  document.querySelector(".main-menu, .sidebar-menu")?.classList.toggle("show-menu")
  
  // Toggle active class on the button
  const button = document.querySelector(".sidebar-button")
  if (button) {
    button.classList.toggle("active")
  }
}

const closeSidebar = () => {
  sidebarOpen.value = false
  document.querySelector(".sidebar-menu")?.classList.remove("show-menu")
}

const closeMenu = () => {
  sidebarOpen.value = false
  document.querySelector(".main-menu, .sidebar-menu")?.classList.remove("show-menu")
  
  const button = document.querySelector(".sidebar-button")
  if (button) {
    button.classList.remove("active")
  }
  
}
const toggleUserMenu = () => {
    userMenuOpen.value = !userMenuOpen.value;
};

// Close dropdown when clicking outside
const closeUserMenu = (event) => {
    if (!event.target.closest('.user-login')) {
        userMenuOpen.value = false;
    }
};

onMounted(() => {
    cart.fetchCartCount();
    document.addEventListener('click', closeUserMenu);
});

// Cleanup event listener
onBeforeUnmount(() => {
    document.removeEventListener('click', closeUserMenu);
});
</script>